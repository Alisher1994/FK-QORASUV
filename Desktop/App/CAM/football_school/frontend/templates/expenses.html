<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—Ö–æ–¥—ã —à–∫–æ–ª—ã</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>‚öΩ {{ system_name }}</h2>
            <button class="sidebar-toggle" aria-label="–°–≤–µ—Ä–Ω—É—Ç—å –º–µ–Ω—é">‚ò∞</button>
        </div>
        <nav>
            <a href="{{ url_for('dashboard') }}" data-tooltip="–ì–ª–∞–≤–Ω–∞—è">üìä <span>–ì–ª–∞–≤–Ω–∞—è</span></a>
            <a href="{{ url_for('students') }}" data-tooltip="–£—á–µ–Ω–∏–∫–∏">üë• <span>–£—á–µ–Ω–∏–∫–∏</span></a>
            <a href="{{ url_for('groups_page') }}" data-tooltip="–ì—Ä—É–ø–ø—ã">üë®‚Äçüë©‚Äçüë¶ <span>–ì—Ä—É–ø–ø—ã</span></a>
            <a href="{{ url_for('tariffs_page') }}" data-tooltip="–¢–∞—Ä–∏—Ñ—ã">üí≥ <span>–¢–∞—Ä–∏—Ñ—ã</span></a>
            <a href="{{ url_for('finances_page') }}" data-tooltip="–§–∏–Ω–∞–Ω—Å—ã">üí∞ <span>–§–∏–Ω–∞–Ω—Å—ã</span></a>
            <a href="{{ url_for('attendance_page') }}" data-tooltip="–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å">üìã <span>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</span></a>
            <a href="{{ url_for('camera_page') }}" data-tooltip="–ö–∞–º–µ—Ä–∞">üì∑ <span>–ö–∞–º–µ—Ä–∞</span></a>
            <a href="{{ url_for('rewards_page') }}" data-tooltip="–í–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è">üèÜ <span>–í–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è</span></a>
            <a href="{{ url_for('rating_page') }}" data-tooltip="–†–µ–π—Ç–∏–Ω–≥ —É—á–µ–Ω–∏–∫–æ–≤">‚≠ê <span>–†–µ–π—Ç–∏–Ω–≥ —É—á–µ–Ω–∏–∫–æ–≤</span></a>
            <a href="{{ url_for('club_settings_page') }}" data-tooltip="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></a>
            <a href="{{ url_for('expenses_page') }}" class="active" data-tooltip="–†–∞—Å—Ö–æ–¥—ã">üì§ <span>–†–∞—Å—Ö–æ–¥—ã</span></a>
            <a href="{{ url_for('cash_page') }}" data-tooltip="–ö–∞—Å—Å–∞">üíµ <span>–ö–∞—Å—Å–∞</span></a>
            <a href="{{ url_for('logout') }}" data-tooltip="–í—ã—Ö–æ–¥">üö™ <span>–í—ã—Ö–æ–¥</span></a>
        </nav>
    </div>

    <div class="main-content">
        <div class="page-header">
            <h1>üí∞ –†–∞—Å—Ö–æ–¥—ã —à–∫–æ–ª—ã</h1>
            <button id="addExpenseBtn" class="btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
        </div>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th>–°—É–º–º–∞</th>
                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for expense in expenses %}
                <tr>
                    <td>{{ expense.expense_date.strftime('%d.%m.%Y %H:%M') }}</td>
                    <td>{{ expense.category }}</td>
                    <td>{{ "%.0f"|format(expense.amount) }} —Å—É–º</td>
                    <td>{{ expense.description or '-' }}</td>
                    <td>
                        <button
                            class="btn-small btn-info edit-expense-btn"
                            data-id="{{ expense.id }}"
                            data-category="{{ expense.category }}"
                            data-amount="{{ expense.amount }}"
                            data-description="{{ expense.description or '' }}"
                        >‚úèÔ∏è</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ -->
    <div id="addExpenseModal" class="modal">
        <div class="modal-content simple-modal">
            <span class="close">&times;</span>
            <h2>–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
            
            <form id="addExpenseForm">
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                    <select name="category" required>
                        <option value="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</option>
                        <option value="–ó–∞—Ä–ø–ª–∞—Ç–∞">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
                        <option value="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
                        <option value="–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ">–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
                        <option value="–ü—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–°—É–º–º–∞ (—Å—É–º) *</label>
                    <input type="number" name="amount" required>
                </div>
                
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea name="description" rows="3"></textarea>
                </div>
                
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ -->
    <div id="editExpenseModal" class="modal">
        <div class="modal-content simple-modal">
            <span class="close edit-close">&times;</span>
            <h2>–ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
            
            <form id="editExpenseForm">
                <input type="hidden" name="id" id="editExpenseId">

                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                    <select name="category" id="editCategory" required>
                        <option value="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</option>
                        <option value="–ó–∞—Ä–ø–ª–∞—Ç–∞">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
                        <option value="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
                        <option value="–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ">–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
                        <option value="–ü—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–°—É–º–º–∞ (—Å—É–º) *</label>
                    <input type="number" name="amount" id="editAmount" required>
                </div>
                
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea name="description" id="editDescription" rows="3"></textarea>
                </div>
                
                <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/expenses.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
</body>
</html>
